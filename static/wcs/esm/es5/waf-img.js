/*! Built with http://stenciljs.com */
import{h}from"./waf.core.js";var WafImg=function(){function t(){this.visibleAsyncLoading=!1,this.isBroken=!1}return t.prototype.render=function(){return this.innerSrc?h("img",{src:this.innerSrc,alt:this.alt,width:this.width,height:this.height,sizes:this.sizes,srcset:this.srcset,decoding:this.decoding}):this.isBroken?h("span",{class:"waf-img__broken",style:this.infoDynamicStyles()},h("span",null,"broken image"),h("span",null,this.alt)):h("span",{class:"waf-img__loading",style:this.infoDynamicStyles()},h("span",{class:"lds-ellipsis"},h("span",null),h("span",null),h("span",null),h("span",null)),h("span",null,this.alt))},t.prototype.componentDidLoad=function(){var t=this;if(this.src)if(this.visibleAsyncLoading&&"IntersectionObserver"in window)this.intersectionObserver=new IntersectionObserver(function(e,n){e.forEach(function(e){if(e.isIntersecting){var i=document.readyState.toString();"loaded"===i||"interactive"===i||"complete"===i?t.srcSwapHandler(t.src):window.addEventListener("load",function(){t.srcSwapHandler(t.src)}),n.disconnect()}})}),this.intersectionObserver.observe(this.wafImg);else{var e=document.readyState.toString();"loaded"===e||"interactive"===e||"complete"===e?this.srcSwapHandler(this.src):window.addEventListener("load",function(){t.srcSwapHandler(t.src)})}else console.warn("waf-img | a src is required"),this.isBroken=!0},t.prototype.componentDidUnload=function(){this.intersectionObserver&&this.intersectionObserver.disconnect()},t.prototype.infoDynamicStyles=function(){return this.width&&this.height?{width:this.width+"px",height:this.height+"px"}:{}},t.prototype.srcSwapHandler=function(t){var e=this;fetch?fetch(t).then(function(t){return t.blob()}).then(function(t){return URL.createObjectURL(t)}).then(function(t){e.isBroken=!1,e.innerSrc=t}).catch(function(){e.isBroken=!0,e.innerSrc=void 0}):(this.isBroken=!1,this.innerSrc=t)},Object.defineProperty(t,"is",{get:function(){return"waf-img"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{alt:{type:String,attr:"alt"},decoding:{type:String,attr:"decoding"},height:{type:String,attr:"height"},innerSrc:{state:!0},isBroken:{state:!0},sizes:{type:String,attr:"sizes"},src:{type:String,attr:"src",watchCallbacks:["srcSwapHandler"]},srcset:{type:String,attr:"srcset"},visibleAsyncLoading:{type:Boolean,attr:"visible-async-loading"},wafImg:{elementRef:!0},width:{type:String,attr:"width"}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return"waf-img{display:inline-block;vertical-align:middle;overflow:hidden}waf-img img{max-width:100%}waf-img .waf-img__broken,waf-img .waf-img__loading{color:#fff;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%;background-color:rgba(0,0,0,.75);-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:2px;padding:.5rem}waf-img .lds-ellipsis{display:inline-block;position:relative;width:64px;height:64px}waf-img .lds-ellipsis span{position:absolute;top:27px;width:11px;height:11px;border-radius:50%;background:#fff;-webkit-animation-timing-function:cubic-bezier(0,1,1,0);animation-timing-function:cubic-bezier(0,1,1,0)}waf-img .lds-ellipsis span:nth-child(1){left:6px;-webkit-animation:.6s infinite lds-ellipsis1;animation:.6s infinite lds-ellipsis1}waf-img .lds-ellipsis span:nth-child(2){left:6px;-webkit-animation:.6s infinite lds-ellipsis2;animation:.6s infinite lds-ellipsis2}waf-img .lds-ellipsis span:nth-child(3){left:26px;-webkit-animation:.6s infinite lds-ellipsis2;animation:.6s infinite lds-ellipsis2}waf-img .lds-ellipsis span:nth-child(4){left:45px;-webkit-animation:.6s infinite lds-ellipsis3;animation:.6s infinite lds-ellipsis3}\@-webkit-keyframes lds-ellipsis1{0%{-webkit-transform:scale(0);transform:scale(0)}100%{-webkit-transform:scale(1);transform:scale(1)}}\@keyframes lds-ellipsis1{0%{-webkit-transform:scale(0);transform:scale(0)}100%{-webkit-transform:scale(1);transform:scale(1)}}\@-webkit-keyframes lds-ellipsis3{0%{-webkit-transform:scale(1);transform:scale(1)}100%{-webkit-transform:scale(0);transform:scale(0)}}\@keyframes lds-ellipsis3{0%{-webkit-transform:scale(1);transform:scale(1)}100%{-webkit-transform:scale(0);transform:scale(0)}}\@-webkit-keyframes lds-ellipsis2{0%{-webkit-transform:translate(0,0);transform:translate(0,0)}100%{-webkit-transform:translate(19px,0);transform:translate(19px,0)}}\@keyframes lds-ellipsis2{0%{-webkit-transform:translate(0,0);transform:translate(0,0)}100%{-webkit-transform:translate(19px,0);transform:translate(19px,0)}}"},enumerable:!0,configurable:!0}),t}();export{WafImg};